(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{5423:function(e,t,a){e.exports=a(5579)},5428:function(e,t,a){},5429:function(e,t,a){},5579:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(17),i=a.n(o),l=(a(5428),a(138)),s=a(35),c=a(36),d=a(37),u=a(39),m=a(38),h=a(40),g=(a(5429),Object(n.createContext)()),p=a(5),v=a(18);var f=Object(v.withStyles)(function(){return{root:{margin:5},textField:{color:"white"}}})(function(e){var t={min:e.min,max:e.max},a=e.classes,o=Object(n.useContext)(g),i=o.handleChange,l=o.handleKeyPress;return r.a.createElement(p.o,{className:a.root,type:e.type,value:e.value,name:e.name,onChange:i,label:e.label,inputProps:t,error:e.error,helperText:e.error?"Invalid token!":"",required:!0,InputProps:e.InputProps,InputLabelProps:{shrink:!0},onKeyPress:l})}),b=a(84);function y(e){var t={startAdornment:r.a.createElement(p.d,{position:"start"},r.a.createElement(b.b,null))},a={startAdornment:r.a.createElement(p.d,{position:"start"},r.a.createElement(b.a,null))};return r.a.createElement(p.c,{container:!0,justify:"center",style:{paddingTop:20}},r.a.createElement(p.c,{item:!0},r.a.createElement(f,{label:"Start date",placeholder:"Enter date..",name:"startDate",value:e.startDate,type:"date",min:"2017-05-01",max:e.endDate,InputProps:t}),r.a.createElement(f,{label:"End date",placeholder:"Enter date..",name:"endDate",value:e.endDate,type:"date",min:e.startDate,max:"2017-06-15",InputProps:t}),r.a.createElement(f,{value:e.token,name:"token",type:"password",label:"API Token",error:!e.validToken,errorText:"Invalid token!",InputProps:a})))}var E=Object(v.withStyles)(function(e){return{root:{marginTop:e.spacing.unit}}})(function(e){var t=e.classes;return r.a.createElement(p.c,{className:t.root,spacing:8,container:!0,justify:"space-evenly"},r.a.createElement(p.c,{item:!0,xs:!0},e.left),r.a.createElement(p.c,{item:!0,xs:!0},e.middle),r.a.createElement(p.c,{item:!0,xs:!0},e.right))}),C=a(141),k=a(34);function D(e,t,a){return t[a]<e[a]?-1:t[a]>e[a]?1:0}var P=[{id:"date",numeric:!1,disablePadding:!1,label:"Date"},{id:"conversation_count",numeric:!0,disablePadding:!1,label:"Conversation count"},{id:"missed_chat_count",numeric:!0,disablePadding:!1,label:"Missed chat count"},{id:"visitors_with_conversation_count",numeric:!0,disablePadding:!1,label:"Visitors with conversation count"}],x=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).createSortHandler=function(e){return function(t){a.props.onRequestSort(t,e)}},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.order,n=t.orderBy;return r.a.createElement(p.j,null,r.a.createElement(p.l,null,P.map(function(t){return r.a.createElement(p.i,{key:t.id,align:"left",padding:t.disablePadding?"none":"default",sortDirection:n===t.id&&a},r.a.createElement(p.q,{title:"Sort",placement:t.numeric?"bottom-end":"bottom-start",enterDelay:300},r.a.createElement(p.m,{active:n===t.id,direction:a,onClick:e.createSortHandler(t.id)},t.label)))},this)))}}]),t}(r.a.Component),j=function(e){var t=e.classes;return r.a.createElement(p.p,{className:t.root},r.a.createElement("div",{className:t.title},r.a.createElement(p.r,{variant:"h6",id:"tableTitle"},"Conversation data")),r.a.createElement("div",{className:t.spacer}))};j=Object(v.withStyles)(function(e){return{root:{paddingRight:e.spacing.unit},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(k.lighten)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},spacer:{flex:"1 1 100%"},actions:{color:e.palette.text.secondary},title:{flex:"0 0 auto"}}})(j);var w=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={order:"asc",orderBy:"date",selected:[],page:0,rowsPerPage:5},a.handleRequestSort=function(e,t){var n=t,r="desc";a.state.orderBy===t&&"desc"===a.state.order&&(r="asc"),a.setState({order:r,orderBy:n})},a.handleChangePage=function(e,t){a.setState({page:t})},a.handleChangeRowsPerPage=function(e){a.setState({rowsPerPage:e.target.value})},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.data,n=this.state,o=n.order,i=n.orderBy,l=n.selected,s=n.rowsPerPage,c=n.page,d=s-Math.min(s,a.length-c*s);return r.a.createElement(p.e,{className:t.root},r.a.createElement(j,{numSelected:l.length}),r.a.createElement("div",{className:t.tableWrapper},r.a.createElement(p.g,{padding:"dense",className:t.table,"aria-labelledby":"tableTitle"},r.a.createElement(x,{numSelected:l.length,order:o,orderBy:i,onSelectAllClick:this.handleSelectAllClick,onRequestSort:this.handleRequestSort,rowCount:a.length}),r.a.createElement(p.h,null,function(e,t){var a=e.map(function(e,t){return[e,t]});return a.sort(function(e,a){var n=t(e[0],a[0]);return 0!==n?n:e[1]-a[1]}),a.map(function(e){return e[0]})}(a,function(e,t){return"desc"===e?function(e,a){return D(e,a,t)}:function(e,a){return-D(e,a,t)}}(o,i)).slice(c*s,c*s+s).map(function(e){return r.a.createElement(p.l,{hover:!0,key:e.date},r.a.createElement(p.i,{align:"left",component:"th",scope:"row"},e.date),r.a.createElement(p.i,{align:"left"},e.conversation_count),r.a.createElement(p.i,{align:"left"},e.missed_chat_count),r.a.createElement(p.i,{align:"left"},e.visitors_with_conversation_count))}),d>0&&r.a.createElement(p.l,{style:{height:49*d}},r.a.createElement(p.i,{colSpan:6}))))),r.a.createElement(p.k,{rowsPerPageOptions:[5],component:"div",count:a.length,rowsPerPage:s,page:c,backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}))}}]),t}(r.a.Component),S=Object(v.withStyles)(function(e){return{root:{marginTop:e.spacing.unit,overflowX:"auto"}}})(w),O=a(140),_=a.n(O);function T(e){var t=e.data,a=[{name:"Conversations",data:(t=t.sort(function(e,t){return e.date<t.date?-1:e.date>t.date?1:0})).map(function(e){return e.conversation_count})},{name:"Missed chats",data:t.map(function(e){return e.missed_chat_count})},{name:"Visitors with conversation",data:t.map(function(e){return e.visitors_with_conversation_count})}],n={chart:{id:"apexchart-example",toolbar:{show:!1},zoom:{enabled:!1}},xaxis:{type:"datetime",categories:t.map(function(e){return e.date}),labels:{show:!1},title:{text:"Date"},axisTicks:{show:!1}},yaxis:{title:{text:"Count"}},legend:{position:"top"},title:{text:"Conversation data",align:"center"}};return r.a.createElement(_.a,{style:{marginTop:10},options:n,series:a,type:"line",width:"100%",height:"450px"})}function N(){return r.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},r.a.createElement(p.b,{disableShrink:!0}))}function I(e){return r.a.createElement(p.c,{container:!0,alignItems:"center",justify:"center",component:"div",style:{minHeight:473}},r.a.createElement(p.c,{item:!0,xs:!0},e.child))}var B=Object(v.withStyles)(function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper},appBar:{backgroundColor:"#0288d1",marginTop:3*e.spacing.unit}}})(function(e){var t=Object(n.useState)(0),a=Object(C.a)(t,2),o=a[0],i=a[1],l=e.classes,s=Object(n.useContext)(g),c=s.dataByDate,d=s.loading;return r.a.createElement("div",{className:l.root},r.a.createElement(p.a,{className:l.appBar,position:"static"},r.a.createElement(p.n,{indicatorColor:"secondary",centered:!0,value:o,onChange:function(e,t){i(t)}},r.a.createElement(p.f,{label:"Table"}),r.a.createElement(p.f,{label:"Chart"}))),0===o&&r.a.createElement(I,{child:d?r.a.createElement(N,null):r.a.createElement(S,{data:c})}),1===o&&r.a.createElement(I,{child:d?r.a.createElement(N,null):r.a.createElement(T,{data:c})}))});function M(e){var t=Object(n.useContext)(g).loading;return r.a.createElement(p.e,{style:{height:"100%",minHeight:170,display:"flex",justifyContent:"center",alignItems:"center"}},r.a.createElement(p.c,{container:!0,direction:"column",alignItems:"center"},r.a.createElement(p.c,{item:!0,xs:!0},r.a.createElement(p.r,{color:"textSecondary",variant:"h6",align:"center"},e.title)),r.a.createElement(p.c,{item:!0,xs:!0},t?r.a.createElement(N,null):r.a.createElement(p.r,{color:"textPrimary",variant:"h4",align:"center",style:{marginTop:"auto"}},e.data))))}var A=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){var t=e.target,n=t.name,r=t.value,o=t.type;r>="2017-05-01"&&r<="2017-06-15"&&"date"===o?a.setState(Object(s.a)({},n,r),function(){a.saveData.startDate=a.state.startDate,a.saveData.endDate=a.state.endDate,localStorage.saveData=JSON.stringify(a.saveData),a.getData()}):a.setState(Object(s.a)({},n,r),function(){a.saveData.token=a.state.token,localStorage.saveData=JSON.stringify(a.saveData)})},a.getData=function(){a.setState({loading:!0});var e="https://api.giosg.com/api/reporting/v1/rooms/84e0fefa-5675-11e7-a349-00163efdd8db/chat-stats/daily/?start_date=".concat(a.state.startDate,"&end_date=").concat(a.state.endDate),t="Token "+a.state.token;fetch(e,{method:"GET",headers:{Authorization:t}}).then(function(e){return 401===e.status?(a.setState({validToken:!1,loading:!1}),Promise.reject(e.status)):e.json()}).then(function(e){a.setState({totalConversationCount:e.total_conversation_count,totalUserMessageCount:e.total_user_message_count,totalVisitorMessageCount:e.total_visitor_message_count,dataByDate:e.by_date,loading:!1,validToken:!0})})},a.handleKeyPress=function(e){"Enter"===e.key&&"token"===e.target.name&&a.getData()},a.getContext=function(){return Object(l.a)({},a.state,{handleChange:a.handleChange,handleKeyPress:a.handleKeyPress})},a.state={startDate:"2017-05-01",endDate:"2017-06-15",token:"",totalConversationCount:0,totalUserMessageCount:0,totalVisitorMessageCount:0,dataByDate:[],validToken:!0,loading:!1},a.saveData=JSON.parse(localStorage.saveData||null)||{},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({startDate:this.saveData.startDate||this.state.startDate,endDate:this.saveData.endDate||this.state.endDate,token:this.saveData.token||this.state.token},function(){""!==e.state.token&&e.getData()})}},{key:"render",value:function(){var e=Object(v.createMuiTheme)({palette:{primary:{light:"#757ce8",main:"#2196f3",dark:"#bbdefb",contrastText:"#fff"},secondary:{light:"#ff7961",main:"#90caf9",dark:"#ba000d",contrastText:"#000"}},typography:{useNextVariants:!0}}),t=this.state,a=t.totalConversationCount,n=t.totalUserMessageCount,o=t.totalVisitorMessageCount,i=t.startDate,l=t.endDate,s=t.token,c=t.validToken,d=this.props.classes;return r.a.createElement(g.Provider,{value:this.getContext()},r.a.createElement(v.MuiThemeProvider,{theme:e},r.a.createElement("div",{className:d.root,style:{padding:10}},r.a.createElement(E,{left:r.a.createElement(M,{title:"Total conversation count",data:a}),middle:r.a.createElement(M,{title:"Total user message count",data:n}),right:r.a.createElement(M,{title:"Total visitor message count",data:o})}),r.a.createElement(y,{startDate:i,endDate:l,token:s,validToken:c}),r.a.createElement(B,null))))}}]),t}(n.Component),R=Object(v.withStyles)(function(){return{root:{backgroundColor:"#03a9f4"}}})(A);a(5578);i.a.render(r.a.createElement(R,null),document.getElementById("root"))}},[[5423,1,2]]]);
//# sourceMappingURL=main.110e65ff.chunk.js.map